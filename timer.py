import timeit
from harmonic_oscillator import *
import matplotlib.pyplot as plt

N = [i for i in range(100, 1000, 100)]
time_40_2 = [1.328999996985658e-05, 3.960799995184061e-05, 0.0002013719999922614, 0.0011417270002311852, 0.002045361000000412, 0.03134820200011745, 0.06355307500007257, 0.10496387200009849, 0.16786213200020939, 0.26032920300031037, 0.37557226299986723, 0.10545166500014602, 0.7284905039996374, 0.9853295070001877, 1.3078039130000434, 1.761175199000263, 2.146503034000034, 2.653893442000026, 3.3110841009997785, 4.292034154000248]
time_50_1 = [2.0730999949591933e-05, 2.9926000024715904e-05, 2.739000001383829e-05, 0.0009079249998649175, 0.002193296999848826, 0.004094319000159885, 0.0067130639999959385, 0.01038626799982012, 0.016618466000181797, 0.02415481300022293, 0.032773323000128585, 0.047474516999955085, 0.06599003800010905, 0.08484388899978512, 0.11590648700030215, 0.14046322800004418, 0.1714698400000998, 0.21006702700015012, 0.25946008300024914, 0.360484359000111, 0.40955619700025636, 0.4570481290002135, 0.5793285580002703, 0.7205638149998776, 0.8146029629997429, 0.9729760840000381, 1.0269307650000883, 1.2030912840000383, 1.3219422910001413, 1.5440551910000977, 1.695235380000213, 2.066507419000118, 2.1485840249997636, 2.546868504000031, 2.7702234229996066, 3.432831198999793, 3.8643011379999734, 4.214661250000063, 4.656527421000192, 5.04302186599989, 5.569857444000263, 6.131239260999791, 6.579039580999961, 7.156206244999794, 7.5967099960003, 8.74928240700001, 9.10454645000027, 10.037323083000047, 10.902217316999668, 11.552630112000315]
time_60_1 = np.array([1.0922999535978306e-05, 5.879999662283808e-06, 6.752000444976147e-06, 0.0008625399996162741, 0.0020954199999323464, 0.003946241999983613, 0.006533798999953433, 0.010159462000046915, 0.016335394999259734, 0.02382723799928499, 0.032382086999859894, 0.04699802699997235, 0.0634251450001102, 0.08084005099954084, 0.10462852699947689, 0.13508289600031276, 0.16733150600066438, 0.206870281999727, 0.25731828900006803, 0.3168008769998778, 0.3726696630001243, 0.44779369500065513, 0.535831528000017, 0.6235901179998109, 0.7250424050007496, 0.8541308899993965, 0.9879852090007262, 1.1271703889997298, 1.28687436600012, 1.4819252819997928, 1.6593203129996255, 1.8841627050005627, 2.1343863150004836, 2.3949932790001185, 2.666751997000574, 2.977915886000119, 3.3255558670007304, 3.680923881000126, 4.079348627999934, 4.518593669000438, 4.925821365000047, 5.449545933999616, 5.967809474000205, 6.518698273000155, 7.1232529679991785, 7.794237690000045, 8.467604806000054, 9.218044509999345, 9.981239077000282, 10.845119022999825, 11.683078240999748, 12.682409783999901, 13.635440179999932, 14.64555652099989, 15.772633685999608, 16.988243697000144, 18.135526427000514, 19.48955561999992, 21.00587478000034, 22.512525765000646])
counter = [0, 0, 0, 15, 24, 29, 33, 37, 44, 49, 52, 60, 65, 68, 73, 79, 83, 87, 93, 99, 102, 107, 113, 117, 121, 127, 132, 135, 140, 146, 149, 154, 160, 164, 168, 173, 178, 182, 187, 192, 195, 200, 205, 209, 214, 219, 223, 227, 232, 237, 241, 247, 251, 255, 260, 265, 269, 274, 280, 284]
time = []

for i in N:
	H = matrix(i, 0.1)
	start = timeit.default_timer()
	M, count = np.linalg.eig(H)
	stop = timeit.default_timer()
	time.append(stop - start)
	#counter.append(count)
print(time)
#print(counter)

'''

fit = np.polynomial.polynomial.Polynomial.fit(N, time_60_1, 3).convert().coef
print(fit)
def f(x):
	return x**3 * fit[3] + x**2 * fit[2] + x * fit[1] + fit[0]

fit_data = []
for i in N:
	fit_data.append(f(i))


fig, ax1 = plt.subplots()

color = 'tab:blue'
ax1.set_xlabel('N-dim')
ax1.set_ylabel('t [s]', color=color)
ax1.plot(N, time_60_1, 'x', color=color, label='čas računanja')
ax1.plot(N, fit_data, '--', color='red', label='fit polinoma 3. stopnje')
ax1.tick_params(axis='y', labelcolor=color)

ax2 = ax1.twinx()

color = 'tab:green'
ax2.set_ylabel('M-QR', color=color)
ax2.plot(N, counter, '+', color=color, label='ponovitve iteracij')
ax2.tick_params(axis='y', labelcolor=color)

fig.tight_layout()  # otherwise the right y-label is slightly clipped
ax1.legend()
ax2.legend(loc='lower right')
plt.show()
'''